import{a as Ce,b as we,c as F,d as N,e as ye}from"./chunk-XXWZIOYB.js";import{a as ve,b as ke}from"./chunk-KRLLF3JD.js";import{b as P}from"./chunk-EQKR7WYR.js";import"./chunk-6HTKW57C.js";import"./chunk-EERASPRL.js";import"./chunk-LHXBPRE2.js";import"./chunk-CK6XGA6X.js";import{a as Q}from"./chunk-AFRAGMDV.js";import"./chunk-THSNLICR.js";import{a as ce}from"./chunk-5AMFDQWK.js";import"./chunk-MB5UDTNQ.js";import"./chunk-OWTGQR6U.js";import"./chunk-IZUVX76I.js";import"./chunk-VQ7XAIYI.js";import"./chunk-C5S2HPP5.js";import"./chunk-425U57QI.js";import"./chunk-7PIM7VCW.js";import"./chunk-GSMGX6RX.js";import{b as be}from"./chunk-7LKCTRLS.js";import"./chunk-MEVQH5BX.js";import{F as Se,l as me,m as de,v as _e,w as ge,x as fe,y as he}from"./chunk-DNVA5LVB.js";import"./chunk-QLTZVGSE.js";import{$b as K,$c as ue,Ba as V,Ca as m,D as I,Da as d,Fc as re,G as v,Ga as M,Gc as le,H as L,Hc as se,I as T,Ic as ae,La as R,Ma as l,Na as S,Nb as q,O as p,Oa as E,P as u,Qa as G,Ra as U,Sa as z,Va as y,Wa as D,_c as pe,aa as r,cb as C,db as w,fc as k,hc as $,ic as J,jc as X,ka as h,kc as x,ma as c,mc as Y,oc as Z,pa as H,pc as ee,qb as j,sb as W,sc as te,tc as ie,uc as ne,va as t,vb as O,vc as oe,wa as i,xa as b,xb as A}from"./chunk-E4UPHNBD.js";import"./chunk-WWX6BADO.js";var Ee=()=>[10,15,50,100],De=()=>["product_name"],Fe=()=>({width:"75vw"}),Ne=()=>({"1199px":"85vw","575px":"90vw"}),B=n=>({"ng-invalid ng-dirty":n});function Pe(n,_){n&1&&(t(0,"th",31),l(1," \u0645\u0639\u062F\u0644 \u0627\u0644\u0643\u0644\u0641\u0629 "),i())}function Me(n,_){n&1&&(t(0,"th",32),l(1," \u0622\u062E\u0631 \u0643\u0644\u0641\u0629 "),i())}function Re(n,_){if(n&1&&(t(0,"tr")(1,"th",25),l(2,"Code"),i(),t(3,"th",26),l(4,"Description"),i(),t(5,"th",25),l(6,"Category"),i(),t(7,"th",25),l(8,"Brand"),i(),t(9,"th",27),l(10," \u0627\u0644\u0643\u0645\u064A\u0629 "),b(11,"p-sortIcon",28),i(),h(12,Pe,2,0,"th",29)(13,Me,2,0,"th",30),t(14,"th",31),l(15,"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629"),i(),t(16,"th",31),l(17,"\u062C\u0645\u0644\u0629"),i(),t(18,"th",31),l(19,"\u0645\u0641\u0631\u0642"),i()()),n&2){let o,s,e=d();r(12),c("ngIf",((o=e.userPermissions())==null?null:o.view_cost)||!1),r(),c("ngIf",((s=e.userPermissions())==null?null:s.view_cost)||!1)}}function qe(n,_){if(n&1&&(t(0,"td"),l(1),C(2,"currency"),i()),n&2){let o=d().$implicit;r(),E(" ",w(2,1,o.avg_cost_usd)," ")}}function Be(n,_){if(n&1&&(t(0,"td"),l(1),C(2,"currency"),i()),n&2){let o=d().$implicit;r(),E(" ",w(2,1,o.unit_cost_usd)," ")}}function Le(n,_){if(n&1&&(t(0,"tr",33)(1,"td"),l(2),i(),t(3,"td"),l(4),i(),t(5,"td"),l(6),i(),t(7,"td"),l(8),i(),t(9,"td"),l(10),i(),h(11,qe,3,3,"td",34)(12,Be,3,3,"td",34),t(13,"td"),l(14),C(15,"currency"),i(),t(16,"td"),l(17),C(18,"currency"),i(),t(19,"td"),l(20),C(21,"currency"),i()()),n&2){let o,s,e=_.$implicit,a=d();c("pSelectableRow",e),r(2),S(e.sku||"---"),r(2),S(e.product_name),r(2),S(e.category_name||"---"),r(2),S(e.brand_name||"---"),r(2),S(e.quantity),r(),c("ngIf",((o=a.userPermissions())==null?null:o.view_cost)||!1),r(),c("ngIf",((s=a.userPermissions())==null?null:s.view_cost)||!1),r(2),E(" ",w(15,11,e.grandwhole_price_usd)," "),r(3),S(w(18,13,e.whole_price_usd)),r(3),S(w(21,15,e.unit_price_usd))}}function He(n,_){n&1&&(t(0,"tr")(1,"td",35),l(2,"No items yet!"),i()())}function Ge(n,_){if(n&1&&(t(0,"div",38)(1,"label",39),l(2,"Cost"),i(),b(3,"input",52),C(4,"currency"),i()),n&2){let o,s=d(2);r(3),M("value",w(4,1,(o=s.selectedItem())==null?null:o.unit_cost_usd))}}function Ue(n,_){n&1&&(t(0,"small",53),l(1,"Grand wholesale is required."),i())}function ze(n,_){n&1&&(t(0,"small",53),l(1,"Wholesale is required."),i())}function je(n,_){n&1&&(t(0,"small",53),l(1,"Price is required."),i())}function We(n,_){if(n&1){let o=V();t(0,"form",36),m("ngSubmit",function(){p(o);let e=d();return u(e.submitItem())}),t(1,"div",37)(2,"div",38)(3,"label",39),l(4,"Item Name"),i(),b(5,"input",40),i(),h(6,Ge,5,3,"div",41),b(7,"div",42),t(8,"div",43)(9,"label",44),l(10,"Grand wholesale (\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629)"),t(11,"span",45),l(12,"*"),i()(),t(13,"p-inputNumber",46),m("onFocus",function(e){p(o);let a=d();return u(a.select(e.target))}),i(),h(14,Ue,2,0,"small",47),i(),t(15,"div",43)(16,"label",48),l(17,"Wholesale (\u062C\u0645\u0644\u0629)"),t(18,"span",45),l(19,"*"),i()(),t(20,"p-inputNumber",49),m("onFocus",function(e){p(o);let a=d();return u(a.select(e.target))}),i(),h(21,ze,2,0,"small",47),i(),t(22,"div",43)(23,"label",50),l(24,"Unit price (\u0645\u0641\u0631\u0642)"),t(25,"span",45),l(26,"*"),i()(),t(27,"p-inputNumber",51),m("onFocus",function(e){p(o);let a=d();return u(a.select(e.target))}),i(),h(28,je,2,0,"small",47),i()()()}if(n&2){let o,s,e=d();c("formGroup",e.itemForm),r(5),M("value",(o=e.selectedItem())==null?null:o.product_name),r(),c("ngIf",((s=e.userPermissions())==null?null:s.view_cost)||!1),r(7),c("ngClass",D(9,B,(e.grandwhole_price_usd==null?null:e.grandwhole_price_usd.invalid)&&((e.grandwhole_price_usd==null?null:e.grandwhole_price_usd.dirty)||(e.grandwhole_price_usd==null?null:e.grandwhole_price_usd.touched)||e.submitted()))),r(),c("ngIf",(e.grandwhole_price_usd==null?null:e.grandwhole_price_usd.invalid)&&((e.grandwhole_price_usd==null?null:e.grandwhole_price_usd.dirty)||(e.grandwhole_price_usd==null?null:e.grandwhole_price_usd.touched)||e.submitted())),r(6),c("ngClass",D(11,B,(e.whole_price_usd==null?null:e.whole_price_usd.invalid)&&((e.whole_price_usd==null?null:e.whole_price_usd.dirty)||(e.whole_price_usd==null?null:e.whole_price_usd.touched)||e.submitted()))),r(),c("ngIf",(e.whole_price_usd==null?null:e.whole_price_usd.invalid)&&((e.whole_price_usd==null?null:e.whole_price_usd.dirty)||(e.whole_price_usd==null?null:e.whole_price_usd.touched)||e.submitted())),r(6),c("ngClass",D(13,B,(e.unit_price_usd==null?null:e.unit_price_usd.invalid)&&((e.unit_price_usd==null?null:e.unit_price_usd.dirty)||(e.unit_price_usd==null?null:e.unit_price_usd.touched)||e.submitted))),r(),c("ngIf",(e.unit_price_usd==null?null:e.unit_price_usd.invalid)&&((e.unit_price_usd==null?null:e.unit_price_usd.dirty)||(e.unit_price_usd==null?null:e.unit_price_usd.touched)||e.submitted))}}function Oe(n,_){if(n&1){let o=V();t(0,"p-button",54),m("onClick",function(){p(o);let e=d();return u(e.closeItemDialog())}),i(),t(1,"p-button",55),m("onClick",function(){p(o);let e=d();return u(e.submitItem())}),i()}if(n&2){let o=d();r(),c("loading",o.submitLoading())}}var Ie=(()=>{class n{constructor(){this.stockService=v(ce),this.stockCorrectionService=v(we),this.printService=v(ve),this.stockTransactionsService=v(Ce),this.authService=v(Q),this.userPermissions=this.authService.userPermissions,this.tableLoading=this.stockService.tableLoading,this.submitLoading=this.stockService.signal_submitLoading,this.itemDialogVisible=this.stockService.signal_itemDialogVisible,this.submitted=this.stockService.signal_submitted,this.products=this.stockService.getProducts(),this.selectedItem=this.stockService.selectedItem,this.disposeDialogVisible=!1,this.itemForm=new X({product_id:new x(null,k.required),unit_price_usd:new x(null,k.required),whole_price_usd:new x(null,k.required),grandwhole_price_usd:new x(null,k.required)}),this.historyDialogVisible=this.stockTransactionsService.historyDialogVisible,this.historyLoading=this.stockTransactionsService.historyLoading}get unit_price_usd(){return this.itemForm.get("unit_price_usd")}get whole_price_usd(){return this.itemForm.get("whole_price_usd")}get grandwhole_price_usd(){return this.itemForm.get("grandwhole_price_usd")}refreshTable(){this.stockService.getItems()}submitItem(){this.itemForm.valid&&this.stockService.updateItem(this.itemForm.value)}closeItemDialog(){this.itemDialogVisible.set(!1)}openItemDialog(){this.itemForm.patchValue(this.selectedItem()),this.itemDialogVisible.set(!0),console.log("openItemDialog",this.itemForm.value)}openDisposeDialog(){this.disposeDialogVisible=!0}disposeItems(o){this.disposeDialogVisible=!1,this.stockService.getItems()}select(o){o.select()}openCorrectStockDialog(){this.stockCorrectionService.stockDialogVisible.set(!0)}onSubmitStockCorrection(o){this.products.update(s=>{let e=this.products().findIndex(a=>a.product_id===o.product_id);return[...s.slice(0,e),o,...s.slice(e+1)]})}printStock(){this.printService.printStock(this.products())}fetchHistory(){this.stockTransactionsService.fetchStockHistory(this.selectedItem().product_id)}closeHistoryDialog(){this.stockTransactionsService.historyDialogVisible.set(!1)}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275cmp=L({type:n,selectors:[["app-stock"]],decls:31,vars:29,consts:[["tableSearch",""],["dt2",""],[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-8","lg:col-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm","w-full",3,"input","value"],[1,"col-4","lg:col-1"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","w-full",3,"click"],["label","Edit","icon","pi pi-pencil","severity","warning","size","small","styleClass","w-full",3,"onClick","disabled"],["label","History","size","small","severity","contrast","icon","pi pi-history","styleClass","w-full",3,"onClick","disabled","loading"],["label","Qty","size","small","severity","info","icon","pi pi-wrench","styleClass","w-full",3,"onClick","disabled"],["label","Print","icon","pi pi-print","size","small","severity","contrast","styleClass","w-full",3,"onClick"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Item","styleClass","p-fluid",3,"visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[3,"onSubmit","onHide","visible","products"],[3,"onSubmit","product_id"],[3,"onClose","visible","product_id"],["width","10%"],["width","25%"],["width","5%","pSortableColumn","quantity"],["field","quantity"],["width","8%",4,"ngIf"],["width","7%",4,"ngIf"],["width","8%"],["width","7%"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","8"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-3"],["for","name"],["id","name","type","text","pInputText","","spellcheck","false","readonly","","disabled","",3,"value"],["class","field col-12 md:col-3",4,"ngIf"],[1,"field","col-12","md:col-6"],[1,"field","col-12","md:col-4"],["for","grandwhole_price_usd"],[1,"text-red-600"],["formControlName","grandwhole_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US","autofocus","true",3,"onFocus","ngClass"],["class","p-error",4,"ngIf"],["for","whole_price_usd"],["formControlName","whole_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",3,"onFocus","ngClass"],["for","unit_price_usd"],["formControlName","unit_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",3,"onFocus","ngClass"],["id","cost","type","text","pInputText","","spellcheck","false","readonly","","disabled","",3,"value"],[1,"p-error"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["type","submit","label","Save","icon","pi pi-check","severity","success","size","small",3,"onClick","loading"]],template:function(s,e){if(s&1){let a=V();t(0,"div",2)(1,"div",3)(2,"p-card")(3,"div",4)(4,"div",5)(5,"span",6),b(6,"i",7),t(7,"input",8,0),m("input",function(f){p(a);let Ve=R(21);return u(Ve.filterGlobal(f.target.value,"contains"))}),i()()(),t(9,"div",9)(10,"p-button",10),m("click",function(){return p(a),u(e.refreshTable())}),i()(),t(11,"div",9)(12,"p-button",11),m("onClick",function(){return p(a),u(e.openItemDialog())}),i()(),t(13,"div",9)(14,"p-button",12),m("onClick",function(){return p(a),u(e.fetchHistory())}),i()(),t(15,"div",9)(16,"p-button",13),m("onClick",function(){return p(a),u(e.openCorrectStockDialog())}),i()(),t(17,"div",9)(18,"p-button",14),m("onClick",function(){return p(a),u(e.printStock())}),i()()(),t(19,"div",3)(20,"p-table",15,1),z("selectionChange",function(f){return p(a),U(e.selectedItem,f)||(e.selectedItem=f),u(f)}),h(22,Re,20,2,"ng-template",16)(23,Le,22,17,"ng-template",17)(24,He,3,0,"ng-template",18),i()()()()(),t(25,"p-dialog",19),h(26,We,29,15,"ng-template",20)(27,Oe,2,1,"ng-template",21),i(),t(28,"dispose-dialog",22),m("onSubmit",function(f){return p(a),u(e.disposeItems(f))})("onHide",function(){return p(a),u(e.disposeDialogVisible=!1)}),i(),t(29,"stock-correction",23),m("onSubmit",function(f){return p(a),u(e.onSubmitStockCorrection(f))}),i(),t(30,"stock-transactions",24),m("onClose",function(){return p(a),u(e.closeHistoryDialog())}),i()}if(s&2){let a,g,f=R(21);r(7),c("value",f.filters.global==null?null:f.filters.global.value),r(5),c("disabled",!e.selectedItem()),r(2),c("disabled",!e.selectedItem())("loading",e.historyLoading()),r(2),c("disabled",!e.selectedItem()),r(4),c("value",e.products()),G("selection",e.selectedItem),c("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",y(25,Ee))("alwaysShowPaginator",!0)("globalFilterFields",y(26,De))("filterDelay",0)("loading",e.tableLoading()),r(5),H(y(27,Fe)),c("visible",e.itemDialogVisible())("modal",!0)("breakpoints",y(28,Ne)),r(3),c("visible",e.disposeDialogVisible)("products",e.products()),r(),c("product_id",(a=e.selectedItem())==null?null:a.product_id),r(),c("visible",e.historyDialogVisible())("product_id",(g=e.selectedItem())==null?null:g.product_id)}},dependencies:[j,W,Y,$,J,Z,ee,_e,K,ge,he,fe,re,se,pe,me,ne,P,N,F,O],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}"]})}}return n})();var Ae=[{path:"",data:{breadcrumb:"Inventory"},component:Ie},{path:"dispose",data:{breadcrumb:"Dispose"},component:ye},{path:"settings",data:{breadcrumb:"Settings"},component:ke}],Te=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=T({type:n})}static{this.\u0275inj=I({imports:[q.forChild(Ae),q]})}}return n})();var Mt=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=T({type:n})}static{this.\u0275inj=I({imports:[A,te,ie,Te,Se,le,ae,be,ue,de,oe,P,N,F]})}}return n})();export{Mt as StockModule};
